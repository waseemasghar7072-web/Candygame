<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Space Vanguard: Blast Zone | BZ247</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap');
        :root { --neon: #00ff88; --pink: #ff0055; --cyan: #00d4ff; --gold: #ffd700; }
        * { user-select: none; touch-action: none; -webkit-tap-highlight-color: transparent; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; font-family: 'Orbitron', sans-serif; color: white; }
        #gameCanvas { display: block; background: #000; }
        .hud { position: absolute; top: 15px; width: 100%; display: flex; justify-content: space-around; pointer-events: none; z-index: 10; }
        .stat { background: rgba(0,0,0,0.8); border: 2px solid var(--cyan); padding: 8px 15px; border-radius: 12px; text-align: center; }
        #overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; }
        .start-btn { background: var(--cyan); color: #000; padding: 20px 50px; border-radius: 50px; font-weight: 900; font-size: 20px; border: none; cursor: pointer; box-shadow: 0 0 30px var(--cyan); }
    </style>
</head>
<body onload="init()">

    <div id="overlay">
        <h1 style="color:var(--cyan); margin-bottom:10px;">VANGUARD: BLAST MODE</h1>
        <p style="color:#aaa; margin-bottom:25px;">COMMANDER WASEEM: ENEMY FIRING DETECTED</p>
        <button class="start-btn" onclick="startMission()">INITIATE COMBAT â–¶</button>
    </div>

    <div class="hud">
        <div class="stat"><span>SCORE</span><br><b id="s">0</b></div>
        <div class="stat"><span>STAGE</span><br><b id="lv">1</b></div>
    </div>

    <canvas id="gameCanvas"></canvas>

<script>
    const canvas = document.getElementById('gameCanvas'), ctx = canvas.getContext('2d');
    
    // PRO FIGHTER JET ASSETS
    let shipImg = new Image(), enemyImg = new Image(), dragonImg = new Image();
    shipImg.src = 'https://cdn-icons-png.flaticon.com/512/3214/3214589.png'; // Fighter Jet Style
    enemyImg.src = 'https://cdn-icons-png.flaticon.com/512/3214/3214643.png'; // Pro Alien Ship
    dragonImg.src = 'https://cdn-icons-png.flaticon.com/512/3063/3063548.png';

    let score = 0, stage = 1, gameActive = false, dragonActive = false;
    let shooting = false, particles = [];
    let player = { x: 0, y: 0, w: 70, h: 70, alive: true };
    let bullets = [], enemyBullets = [], enemies = [];

    let audioCtx;
    function initAudio() { audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }

    function playSound(f, type, d, v=0.05) {
        if(!audioCtx) return;
        let o = audioCtx.createOscillator(), g = audioCtx.createGain();
        o.type = type; o.frequency.setValueAtTime(f, audioCtx.currentTime);
        g.gain.setValueAtTime(v, audioCtx.currentTime);
        o.connect(g); g.connect(audioCtx.destination);
        o.start(); o.stop(audioCtx.currentTime + d);
    }

    function startMission() {
        document.getElementById('overlay').style.display = 'none';
        initAudio();
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        player.x = canvas.width/2 - 35; player.y = canvas.height - 180;
        gameActive = true; loop();
    }

    canvas.addEventListener('touchstart', (e) => { shooting = true; updatePos(e); });
    canvas.addEventListener('touchmove', updatePos);
    canvas.addEventListener('touchend', () => shooting = false);

    function updatePos(e) {
        if(!gameActive || !player.alive) return;
        let t = e.touches[0];
        player.x = t.clientX - 35;
        player.y = t.clientY - 90;
    }

    // Interval: Shooting Logic
    setInterval(() => { if(shooting && gameActive && player.alive) firePlayer(); }, 150);
    setInterval(() => { if(gameActive && !dragonActive && player.alive) spawnEnemy(); }, 1200);
    setInterval(() => { if(gameActive && player.alive) enemies.forEach(e => { if(Math.random() < 0.3) fireEnemy(e); }); }, 1800);

    function firePlayer() {
        bullets.push({ x: player.x + 32, y: player.y, w: 6, h: 22 });
        playSound(800, 'sawtooth', 0.04, 0.03);
    }

    function fireEnemy(e) {
        enemyBullets.push({ x: e.x + e.w/2, y: e.y + e.h, w: 5, h: 15 });
    }

    function spawnEnemy() {
        enemies.push({ x: Math.random()*(canvas.width-60), y: -70, w: 60, h: 60, s: 2.5 + (stage * 0.5) });
    }

    // BLAST EFFECT LOGIC
    function createExplosion(x, y, color) {
        for(let i=0; i<15; i++) {
            particles.push({
                x: x, y: y,
                vx: (Math.random()-0.5)*10, vy: (Math.random()-0.5)*10,
                life: 30, color: color
            });
        }
    }

    function loop() {
        if(!gameActive) return;
        ctx.fillStyle = "black"; ctx.fillRect(0, 0, canvas.width, canvas.height);

        // --- BLAST PARTICLES ---
        particles.forEach((p, i) => {
            p.x += p.vx; p.y += p.vy; p.life--;
            ctx.fillStyle = p.color; ctx.fillRect(p.x, p.y, 4, 4);
            if(p.life <= 0) particles.splice(i, 1);
        });

        // --- PLAYER BULLETS (Gold) ---
        bullets.forEach((b, i) => {
            b.y -= 14;
            ctx.fillStyle = (stage === 1) ? "#ffd700" : "#00d4ff";
            ctx.fillRect(b.x, b.y, b.w, b.h);
            if(b.y < -30) bullets.splice(i, 1);
        });

        // --- ENEMY BULLETS (Red) ---
        enemyBullets.forEach((eb, i) => {
            eb.y += 8;
            ctx.shadowBlur = 10; ctx.shadowColor = "#ff0055";
            ctx.fillStyle = "#ff0055"; ctx.fillRect(eb.x, eb.y, eb.w, eb.h);
            ctx.shadowBlur = 0;
            
            // SHIP BLAST: Enemy hit Player
            if(player.alive && eb.x > player.x && eb.x < player.x + player.w && eb.y > player.y && eb.y < player.y + player.h) {
                player.alive = false;
                createExplosion(player.x + 35, player.y + 35, "#00d4ff");
                playSound(100, 'square', 0.3, 0.2); 
                setTimeout(() => { alert("SHIP BLASTED! MISSION FAILED."); location.reload(); }, 1000);
            }
            if(eb.y > canvas.height) enemyBullets.splice(i, 1);
        });

        // --- ENEMIES ---
        enemies.forEach((e, i) => {
            e.y += e.s;
            ctx.drawImage(enemyImg, e.x, e.y, e.w, e.h);
            
            // SHIP BLAST: Player hit Enemy
            bullets.forEach((b, bi) => {
                if(b.x < e.x + e.w && b.x + b.w > e.x && b.y < e.y + e.h && b.y + b.h > e.y) {
                    createExplosion(e.x + 30, e.y + 30, "#ff5500");
                    enemies.splice(i, 1); bullets.splice(bi, 1);
                    score += 50; document.getElementById('s').innerText = score;
                    playSound(200, 'square', 0.1, 0.1);
                    if(navigator.vibrate) navigator.vibrate(30);
                }
            });

            // Collision Blast: Player hits Enemy ship
            if(player.alive && e.x < player.x + player.w && e.x + e.w > player.x && e.y < player.y + player.h && e.y + e.h > player.y) {
                player.alive = false;
                createExplosion(player.x + 35, player.y + 35, "white");
                enemies.splice(i, 1);
                setTimeout(() => { alert("COLLISION BLAST! GAME OVER."); location.reload(); }, 1000);
            }
            if(e.y > canvas.height) enemies.splice(i, 1);
        });

        // Drawing Player
        if(player.alive) {
            ctx.shadowBlur = 15; ctx.shadowColor = "rgba(0, 212, 255, 0.4)";
            ctx.drawImage(shipImg, player.x, player.y, player.w, player.h);
            ctx.shadowBlur = 0;
        }

        requestAnimationFrame(loop);
    }
</script>
</body>
</html>
