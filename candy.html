<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Candy Mafia: Waseem Productions</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Bebas+Neue&display=swap');
        
        :root { --gold: #ffd700; --neon: #ff00ff; }

        body { 
            margin: 0; padding: 0; font-family: 'Fredoka One', cursive; 
            background: #050505; color: white; overflow: hidden; 
            display: flex; flex-direction: column; align-items: center;
            touch-action: none; perspective: 1000px;
        }

        /* Header Fix for Mobile */
        .header { 
            width: 100%; padding: 10px 0; background: rgba(0,0,0,0.9);
            display: flex; justify-content: space-around; align-items: center; 
            border-bottom: 2px solid var(--gold); font-size: 14px;
        }
        .stat b { color: var(--gold); }

        /* Responsive Board - Screen par fit karne ke liye */
        .board-bg { 
            background: rgba(255, 215, 0, 0.03); 
            padding: 8px; border-radius: 15px; 
            margin: 20px auto; border: 3px solid var(--gold); 
            width: 92vw; /* Phone ki width ke hisaab se */
            max-width: 400px; /* Tablet/Desktop par zyada bada na ho */
            box-sizing: border-box;
            transform: rotateX(10deg);
        }

        .grid { 
            display: grid; 
            grid-template-columns: repeat(8, 1fr); /* 8 barabar columns */
            gap: 4px; 
        }

        .slot { 
            aspect-ratio: 1/1; /* Square shape */
            background: rgba(255,255,255,0.05); 
            border-radius: 6px; 
            display: flex; align-items: center; justify-content: center; 
        }

        .fruit { 
            font-size: 6.5vw; /* Icons screen ke hisaab se chote honge */
            max-font-size: 32px;
            cursor: pointer; transition: transform 0.2s; user-select: none;
        }

        @media (min-width: 500px) { .fruit { font-size: 32px; } }

        /* VFX Popups */
        .vfx-text {
            position: fixed; pointer-events: none; color: var(--gold);
            font-family: 'Bebas Neue'; font-size: 30px; text-shadow: 0 0 10px #000;
            animation: float 0.8s ease-out forwards; z-index: 1000;
        }
        @keyframes float { 0% { opacity: 1; transform: translate(-50%, 0) scale(1); } 100% { opacity: 0; transform: translate(-50%, -80px) scale(1.5); } }
    </style>
</head>
<body>

    <div class="header">
        <div class="stat">Cash: <b id="coins">0</b></div>
        <div style="font-family: 'Bebas Neue'; color: var(--gold); font-size: 20px;">MAFIA MISSION</div>
        <div class="stat">Moves: <b id="moves">30</b></div>
    </div>
    
    <div id="vfx-box"></div>

    <div class="board-bg" id="board">
        <div class="grid" id="grid"></div>
    </div>

<script>
    const gridEl = document.getElementById('grid'), coinsEl = document.getElementById('coins'), movesEl = document.getElementById('moves');
    const items = ['üî´', 'üï∂Ô∏è', 'üíµ', 'üíé', 'üö¨', 'üöó'];
    const quotes = ["JHAKAS!", "DHAMAKA!", "DON STYLE!", "MAFIA!"];
    let squares = [], moves = 30, coins = 0, sX, sY;

    function init() {
        gridEl.innerHTML = ''; squares = [];
        for (let i = 0; i < 64; i++) {
            const f = document.createElement('div'); f.className = 'fruit';
            f.innerHTML = items[Math.floor(Math.random()*6)];
            // Touch Swiping Logic
            f.ontouchstart = (e) => { sX = e.touches[0].clientX; sY = e.touches[0].clientY; };
            f.ontouchend = (e) => { 
                let dX = e.changedTouches[0].clientX - sX, dY = e.changedTouches[0].clientY - sY;
                if(Math.abs(dX) > 20 || Math.abs(dY) > 20) {
                    let dir = Math.abs(dX) > Math.abs(dY) ? (dX > 0 ? 1 : -1) : (dY > 0 ? 8 : -8);
                    move(i, i + dir);
                }
            };
            const slot = document.createElement('div'); slot.className = 'slot';
            slot.appendChild(f); gridEl.appendChild(slot); squares.push(f);
        }
        check();
    }

    function move(id1, id2) {
        if (id2 < 0 || id2 >= 64 || (Math.abs(id1 - id2) === 1 && Math.floor(id1/8) !== Math.floor(id2/8))) return;
        let t = squares[id1].innerHTML; squares[id1].innerHTML = squares[id2].innerHTML; squares[id2].innerHTML = t;
        if(!check()) {
            setTimeout(() => { let t = squares[id1].innerHTML; squares[id1].innerHTML = squares[id2].innerHTML; squares[id2].innerHTML = t; }, 250);
        } else {
            moves--; movesEl.innerText = moves;
        }
    }

    function check() {
        let matches = new Set();
        for(let i=0; i<64; i++) {
            let r = Math.floor(i/8), c = i%8;
            if(c < 6 && squares[i].innerHTML === squares[i+1].innerHTML && squares[i].innerHTML === squares[i+2].innerHTML) { matches.add(i); matches.add(i+1); matches.add(i+2); }
            if(r < 6 && squares[i].innerHTML === squares[i+8].innerHTML && squares[i].innerHTML === squares[i+16].innerHTML) { matches.add(i); matches.add(i+8); matches.add(i+16); }
        }
        if(matches.size > 0) {
            if(matches.size >= 4) showVFX();
            matches.forEach(id => { squares[id].style.opacity = "0"; });
            coins += matches.size * 10; coinsEl.innerText = coins;
            setTimeout(fill, 300); return true;
        }
        return false;
    }

    function showVFX() {
        const v = document.createElement('div'); v.className = 'vfx-text';
        v.innerText = quotes[Math.floor(Math.random()*quotes.length)];
        v.style.left = "50%"; v.style.top = "50%";
        document.body.appendChild(v);
        setTimeout(() => v.remove(), 800);
    }

    function fill() {
        squares.forEach(s => { if(s.style.opacity === "0") { s.innerHTML = items[Math.floor(Math.random()*6)]; s.style.opacity = "1"; } });
        setTimeout(check, 300);
    }

    window.onload = init;
</script>
</body>
</html>
